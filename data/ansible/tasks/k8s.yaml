#
# (C) Copyright IBM Corp. 2023.
# SPDX-License-Identifier: Apache-2.0
#

---
- name: "Add gpg key "
  apt_key:
    url: https://pkgs.k8s.io/core:/stable:/v{{ kube_version }}/deb/Release.key
    state: present
    
- name: Add Docker GPG apt Key
  apt_key:
    url: https://download.docker.com/linux/ubuntu/gpg
    state: present
        
- name: Add Docker Repository
  apt_repository:
    repo: deb https://download.docker.com/linux/ubuntu jammy stable
    state: present
        
- name: "Add kubernetes source list "
  apt_repository:
    repo: "deb https://pkgs.k8s.io/core:/stable:/v{{ kube_version }}/deb/ /"
    state: present
    filename: "kubernetes"

- name: "Install containerd.io "
  apt:
    update_cache: true
    name: ['containerd.io']
    state: present
    
- name: "Install kubelet, kubeadm, kubectl "
  apt:
    update_cache: true
    name: ['kubelet', 'kubeadm', 'kubectl', 'kubernetes-cni', 'cri-tools']
    state: present
